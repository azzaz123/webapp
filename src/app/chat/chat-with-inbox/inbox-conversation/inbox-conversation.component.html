<div [ngClass]="{'faded': conversation.user.blocked || !conversation.user.available}">
  <tsl-item-avatar [item]="conversation?.item"></tsl-item-avatar>
  <div class="conversation-info" *ngIf="conversation">
    <div class="user-name-row" [ngClass]="{'has-phone': true}">
      <div class="user-name-row-left">
        <p class="user-name">
          <span *ngIf="conversation.phoneShared">
            <mat-icon svgIcon="call-shared"></mat-icon>
          </span>
          <span *ngIf="!conversation.user.available">
            <mat-icon svgIcon="not-available" class="not-available"></mat-icon>
          </span>
          <span *ngIf="conversation.user.blocked">
            <mat-icon svgIcon="blocked" class="blocked"></mat-icon>
          </span>
          <span [ngClass]="{'blocked': conversation.user.blocked}">
            {{conversation.user.microName}}
          </span>
        </p>
      </div>
      <div class="user-name-row-right">
        <span class="message-date" *ngIf="dateIsThisYear()">{{conversation?.modifiedDate| amCalendar:momentConfig }}</span>
        <span class="message-date" *ngIf="!dateIsThisYear()">{{conversation?.modifiedDate| amDateFormat:'D MMM. YYYY' }}</span>
      </div>
    </div>

    <div class="item-title-row">
      <div class="conversation-item-title">
        <span>{{conversation.item.title}}</span>
      </div>
      <div class="conversation-item-meta">
        <span [hidden]="conversation.unreadCounter === 0" class="badge badge-primary badge-pill">
          <span *ngIf="conversation.unreadCounter <= unreadCounterDisplayLimit">{{ conversation.unreadCounter }}</span>
          <span *ngIf="conversation.unreadCounter > unreadCounterDisplayLimit" i18n>{{ unreadCounterDisplayLimit }}+</span>
        </span>
      </div>
    </div>

    <div class="message-row" [ngClass]="{'showStatus': conversation.lastMessage.fromSelf && conversation.lastMessage.status }">
      <div class="message-status" [ngClass]="conversation.lastMessage.status" *ngIf="conversation.lastMessage.fromSelf && conversation.lastMessage.status"></div>
      <p class="message">
        {{conversation.lastMessage.message}}
      </p>
    </div>
  </div>
</div>