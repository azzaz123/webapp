<div class="top-bar" [ngClass]="{'faded': !currentConversation.user.available, 'expanded': isExpanded}">
  <mat-icon svgIcon="back-arrow" class="d-lg-none back-arrow" (click)="navigationBack()"></mat-icon>

  <div class="lg-device-container d-none d-lg-inline-flex">
    <a *ngIf="currentConversation?.user.profileUrl" href="{{ currentConversation?.user.profileUrl }}"
       target="_blank" class="user-avatar">
      <tsl-user-avatar [user]="this.currentConversation.user" size="40"></tsl-user-avatar>
    </a>
    <tsl-user-avatar *ngIf="!currentConversation?.user.profileUrl" [user]="this.currentConversation.user" size="40">
    </tsl-user-avatar>

    <h5>{{currentConversation?.user.microName}}</h5>
  </div>

  <div class="sm-device-container d-lg-none"
       [ngClass]="{'expanded': isExpanded, 'faded': !currentConversation.user.available}">

    <div class="avatar-container">
      <div class="avatar">
        <tsl-item-avatar [item]="currentConversation.item"
                         size="{{isExpanded ? 'rectangle-xl': 'medium'}}"></tsl-item-avatar>
      </div>
    </div>

    <div (click)="expand()" class="item-details">
      <div *ngIf="currentConversation.item.price">
        {{currentConversation.item.price.amount | customCurrency:currentConversation.item.price.currency}}</div>
      <div class="text-truncate">{{currentConversation.item.title}}</div>

      <div [ngClass]="{'user-detail-dropdown': isExpanded}" class="user-detail">
        <hr *ngIf="isExpanded">
        <tsl-inbox-user-detail [item]="currentConversation.item"
                               [user]="currentConversation.user"
                               [avatarSize]="40"></tsl-inbox-user-detail>
      </div>
    </div>
  </div>

  <div ngbDropdown placement="bottom-right" class="conversation-header-menu" [ngClass]="{'expanded': isExpanded}">

    <div class="d-lg-none">
      <a *ngIf="currentConversation?.user.profileUrl" href="{{ currentConversation?.user.profileUrl }}"
         target="_blank" class="user-avatar">
        <tsl-user-avatar [user]="this.currentConversation.user" size="40"></tsl-user-avatar>
      </a>
    </div>

    <mat-icon class="menu-icon" svgIcon="menu" ngbDropdownToggle></mat-icon>
    <div ngbDropdownMenu>
      <button class="dropdown-item" (click)="archiveConversation()" i18n
              [hidden]="currentConversationisArchived">Archive conversation
      </button>
      <button class="dropdown-item" (click)="unarchiveConversation()" i18n
              [hidden]="!currentConversationisArchived">Unarchive conversation
      </button>
      <button class="dropdown-item" (click)="reportListingAction()"
              *ngIf="!itemIsMine && !currentConversation.item.notAvailable" i18n>Report this Listing
      </button>
      <button *ngIf="currentConversation.user.available"
              class="dropdown-item" (click)="reportUserAction()" i18n>Report this User
      </button>
      <button [hidden]="!currentConversation.user.id || currentConversation.user.blocked"
              class="dropdown-item warn"
              (click)="blockUserAction()" i18n>Block this User
      </button>
      <button [hidden]="!currentConversation.user.id || !currentConversation.user.blocked"
              class="dropdown-item warn"
              (click)="unblockUserAction()" i18n>Unblock this User
      </button>
    </div>
  </div>

</div>
