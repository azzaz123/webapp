<div class="top-bar" [ngClass]="{'faded': !currentConversation.user.available, 'expanded': isExpanded}">
  <mat-icon svgIcon="back-arrow" class="hidden-xl-up back-arrow" (click)="navigationBack()"></mat-icon>

  <div class="lg-device-container hidden-lg-down">
    <a *ngIf="currentConversation?.user.profileUrl" href="{{ currentConversation?.user.profileUrl }}"
       target="_blank" class="user-avatar">
      <tsl-user-avatar [user]="this.currentConversation.user" size="40"></tsl-user-avatar>
    </a>
    <tsl-user-avatar *ngIf="!currentConversation?.user.profileUrl" [user]="this.currentConversation.user" size="40">
    </tsl-user-avatar>

    <h5>{{currentConversation?.user.microName}}</h5>
  </div>


  <div ngbDropdown placement="bottom-right" class="conversation-header-menu">

    <div *ngIf="!isExpanded" class="user-avatar hidden-xl-up">
      <a *ngIf="currentConversation?.user.profileUrl" href="{{ currentConversation?.user.profileUrl }}"
         target="_blank" class="user-avatar">
        <tsl-user-avatar [user]="this.currentConversation.user" size="40"></tsl-user-avatar>
      </a>
    </div>

    <mat-icon class="menu-icon" svgIcon="menu" ngbDropdownToggle></mat-icon>
    <div ngbDropdownMenu>
      <button class="dropdown-item" (click)="archiveConversation()" i18n
              [hidden]="currentConversationisArchived">Archive conversation
      </button>
      <button class="dropdown-item" (click)="unarchiveConversation()" i18n
              [hidden]="!currentConversationisArchived">Unarchive conversation
      </button>
      <button class="dropdown-item" (click)="reportListingAction()"
              *ngIf="!itemIsMine && !currentConversation.item.notAvailable" i18n>Report this Listing
      </button>
      <button *ngIf="currentConversation.user.available"
              class="dropdown-item" (click)="reportUserAction()" i18n>Report this User
      </button>
      <button [hidden]="!currentConversation.user.id || currentConversation.user.blocked"
              class="dropdown-item warn"
              (click)="blockUserAction()" i18n>Block this User
      </button>
      <button [hidden]="!currentConversation.user.id || !currentConversation.user.blocked"
              class="dropdown-item warn"
              (click)="unblockUserAction()" i18n>Unblock this User
      </button>
    </div>
  </div>
</div>

<div class="sm-device-container hidden-xl-up"
     [ngClass]="{'expanded': isExpanded, 'faded': !currentConversation.user.available}">
  <tsl-item-avatar [item]="currentConversation.item" class="hidden-sm-down"
                   size="{{isExpanded ? 'xl': 'medium'}}"></tsl-item-avatar>
  <tsl-item-avatar [item]="currentConversation.item" class="hidden-md-up"
                   size="{{isExpanded ? 'rectangle-xl': 'medium'}}"></tsl-item-avatar>

  <div (click)="expand()" class="item-details">
    <div *ngIf="currentConversation.item.price">
      {{currentConversation.item.price.amount | customCurrency:currentConversation.item.price.currency}}</div>
    <div>{{currentConversation.item.title}}</div>

    <div *ngIf="isExpanded" [ngClass]="{'user-detail-dropdown': isExpanded}"
         class="user-detail hidden-xl-up">
      <hr>
      <tsl-inbox-user-detail [item]="currentConversation.item"
                             [user]="currentConversation.user"
                             [avatarSize]="40"></tsl-inbox-user-detail>
    </div>
  </div>

</div>
