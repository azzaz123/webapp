<div class="inbox-conversation-container"
     [ngClass]="{'faded': conversation.cannotChat, 'inbox-archived-container': archiveConversation}">
  <tsl-item-avatar [item]="conversation?.item" [inboxItem]="conversation?.item" [showAvailableStatus]="true"></tsl-item-avatar>
  <div class="conversation-info" *ngIf="conversation">
    <div class="user-name-row">
      <div class="user-name-row-left">
        <p class="user-name">
        <span *ngIf="conversation.phoneNumber && !!conversation.item.isMine" class="call-shared">
            <mat-icon svgIcon="call-shared"></mat-icon>
          </span>
          <span *ngIf="!conversation.user.available && !conversation.user.blocked">
            <mat-icon svgIcon="not-available" class="not-available"></mat-icon>
          </span>
          <span *ngIf="conversation.user.blocked">
            <mat-icon svgIcon="blocked" class="blocked"></mat-icon>
        </span>
          <span>{{conversation.user.microName}}</span>
        </p>
      </div>
      <div class="user-name-row-right">
        <span class="message-date"
              *ngIf="dateIsThisYear()">{{conversation?.modifiedDate| amCalendar:momentConfig }}</span>
        <span class="message-date"
              *ngIf="!dateIsThisYear()">{{conversation?.modifiedDate| date:'d MMM. yyyy' }}</span>
      </div>
    </div>

    <div class="item-message-row">
      <div class="item-title-message-column">
        <div class="item-title-row">
          <span>{{conversation.item.title}}</span>
        </div>

        <div class="message-row"
             [ngClass]="{'showStatus': conversation.lastMessage && conversation.lastMessage.fromSelf && conversation.lastMessage.status }">
          <div class="message-status" [ngClass]="conversation.lastMessage.status"
               *ngIf="conversation.lastMessage && conversation.lastMessage.fromSelf && conversation.lastMessage.status"></div>
          <p *ngIf="conversation.lastMessage && isText(conversation.lastMessage)"
             class="message">{{conversation.lastMessage.text}}</p>
          <p *ngIf="conversation.lastMessage && isThirdVoiceDropPrice(conversation.lastMessage.type)" class="message">
            <tsl-third-voice-drop-price [message]="conversation.lastMessage"
                                        [shortMessage]="true"></tsl-third-voice-drop-price>
          </p>
          <p *ngIf="conversation.lastMessage && isThirdVoiceReview(conversation.lastMessage.type)" class="message">
            <tsl-third-voice-review [message]="conversation.lastMessage" [user]="conversation.user"
                                    [item]="conversation.item"
                                    [shortMessage]="true"></tsl-third-voice-review>
          </p>
        </div>
      </div>
      <div class="unread-counter-column">
        <div class="badge badge-pill badge-primary" [hidden]="conversation.unreadCounter === 0">
            <span
              *ngIf="conversation.unreadCounter <= unreadCounterDisplayLimit">{{ conversation.unreadCounter }}</span>
          <span *ngIf="conversation.unreadCounter > unreadCounterDisplayLimit">{{ unreadCounterDisplayLimit }}+</span>
        </div>
        <div class="badge badge-archive" *ngxPermissionsOnly="['isProfessional']">
          <button class="check-corporate" (click)="$event.stopPropagation(); onClickArchiveConversation()">
            <mat-icon svgIcon="check"></mat-icon>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
