<div class="Search"
  infinite-scroll
  [infiniteScrollDistance]="0"
  [infiniteScrollThrottle]="150"
  [infiniteScrollDisabled]="infiniteScrollDisabled$ | async"
  (scrolled)="scrolled()">
  <tsl-filters-wrapper class="Search__filters position-fixed"
    [class.Search__filters--with-backdrop]="(openBubbleCount$ | async) !== 0"
    (bubbleFilterOpenStateChange)="toggleBubbleFilterBackdrop($event)">
  </tsl-filters-wrapper>

  <tsl-search-layout class="Search__layout d-block" *ngIf="(items$ | async).length > 0">
    <div top class="d-block h-100 position-relative">
      <tsl-sky [adSlot]="adSlots.search1"></tsl-sky>
    </div>
    <div bottom class="d-block h-100 position-relative">This should be an ad - Bottom</div>
    <div right class="d-block h-100 position-relative">
      <ng-container *ngIf="device === DevicesType.DESKTOP">
        <div class="w-100 mb-3 Search__ad--top">
          <div class="position-sticky w-100 Search__ad--topSpace">
            <tsl-sky [adSlot]="adSlots.search2r"></tsl-sky>
          </div>
        </div>
        <div class="w-100 Search__ad--bottom">
          <div class="position-sticky w-100 Search__ad--topSpace">
            <tsl-sky [adSlot]="adSlots.search3r"></tsl-sky>
          </div>
        </div>
      </ng-container>
    </div>
    <ng-container main>
      <tsl-public-item-card-list [items]="items$ | async" [columnsConfig]="columnsConfig" [slotsConfig]="slotsConfig">
        <ng-template #slotTemplate let-index>
          <ng-container *ngIf="isWall$ | async; else templateSearchAds">
            <tsl-sky [adSlot]="adNativeSlotsConfiguration.regular"></tsl-sky>
          </ng-container>
        </ng-template>
      </tsl-public-item-card-list>
      <ng-container *ngIf="infiniteScrollDisabled$ | async" >
        <div class="row justify-content-center my-4" *ngIf="hasMoreItems$ | async">
          <tsl-button id="btn-load-more" (click)="loadMoreProducts()" i18n="web_search_component_load_more_products">Ver más productos</tsl-button>
        </div>
        <div *ngIf="device === DevicesType.DESKTOP && (isWall$ | async) === false" class="row justify-content-center my-4">
          <tsl-sky-slot-group-shopping *ngIf="isWall$ | async" [adSlotShoppingConfiguration]="adSlotGroupShoppingConfiguration" [adShoppingPageOptions]="adShoppingGroupPageOptions"></tsl-sky-slot-group-shopping>
        </div>
      </ng-container>
    </ng-container>
  </tsl-search-layout>

  <tsl-search-error-layout *ngIf="(items$ | async).length === 0 && (isLoadingResults$ | async) === false">
  </tsl-search-error-layout>
</div>

<ng-template #templateSearchAds>
  <tsl-sky-shopping [adSlotContainer]="adSlotNativeShoppingContainer" [adShoppingPageOptions]="adShoppingNativeListPageOptions" [index]="index"></tsl-sky-shopping>
</ng-template>
