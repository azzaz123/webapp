<div class="page-content"
     infiniteScroll
     [infiniteScrollDistance]="5"
     [infiniteScrollThrottle]="100"
     [scrollWindow]="false"
     [infiniteScrollDisabled]="end || loading"
     (scrolled)="loadMore()">
  <tsl-spinner [firstLoad]="false" *ngIf="isUrgent && isRedirect"></tsl-spinner>
  <div class="container">
    <div class="header">
      <div class="left-col">
        <h2 i18n>Catalog <span class="badge badge-pro">Pro</span></h2>
        <div class="intro"><span i18n>Big packages with all your items and stuff</span> <div class="border"></div>
          <span><a href="" tslTrackEvent="MYCATALOG_PRO_MANAGE_SUBSCRIPTION" class="corporate" i18n>Manage my subscription</a></span>
        </div>
      </div>
      <tsl-button className="btn btn-logout" [routerLink]="['pro/catalog/checkout-extras']" tslTrackEvent="MYCATALOG_PRO_PURCHASE_EXTRAS"
                  i18n>Purchase extras</tsl-button>
    </div>
    <tsl-plan-data [counters]="counters" [plannedCityPurchase]="itemService.plannedCityPurchase"
                   [plannedCountryPurchase]="itemService.plannedCountryPurchase" (subscriptionPlan)="getSubscriptionPlan($event)">
    </tsl-plan-data>
    <tsl-search-input (term)="search($event)"></tsl-search-input>
    <tsl-catalog-status-navbar (filterByStatus)="filterByStatus($event)" [selectedStatus]="selectedStatus"
                               [counters]="counters" [subscriptionPlan]="subscriptionPlan"></tsl-catalog-status-navbar>
    <tsl-select [items]="orderBy" (valueChanges)="sort($event)" [value]="sortBy" class="float-right"></tsl-select>
    <div id="top-buttons">
      <tsl-catalog-item-actions (getCounters)="getCounters()" [active]="active" [items]="items"
                                [selectedStatus]="selectedStatus"></tsl-catalog-item-actions>
      <tsl-button className="btn-primary" [routerLink]="['/catalog/upload']" tslTrackEvent="MYCATALOG_PRO_UPLOAD"
                  i18n>List a product</tsl-button>
    </div>
    <div class="row items">
      <a class="add-item col-md-12"
         [routerLink]="['/catalog/upload']"
         *ngIf="(!loading || (loading && items.length)) && selectedStatus === 'published'">
      </a>
      <div id="catalog-empty-state" *ngIf="!items.length && !loading || subscriptionPlan - counters?.publish > 0">
        <mat-icon svgIcon="pro-items-empty-state" class="image"></mat-icon>
        <div class="empty-text" *ngIf="subscriptionPlan - counters?.publish > 0 && counters?.onHold <= 0 && selectedStatus === 'active'">
          <span i18n>You can publish <b>{{subscriptionPlan - counters.publish}} more cars</b> with your current plan.</span>
          <span i18n><a href="/catalog/upload">Upload now</a></span>
        </div>
        <div class="empty-text" *ngIf="subscriptionPlan - counters?.publish > 0 && counters?.onHold > 0 && selectedStatus === 'active'">
          <span i18n>You can publish <b>{{subscriptionPlan - counters?.publish}} more cars</b> with your current plan.</span>
          <span i18n><a class="link" (click)="filterByStatus('pending')">Activate cars</a></span>
        </div>
      </div>
      <tsl-catalog-card *ngFor="let item of items" class="col-md-12" [item]="item" (itemChange)="itemChanged($event)">
      </tsl-catalog-card>
      <tsl-spinner [hidden]="!loading"></tsl-spinner>
    </div>
  </div>
</div>
